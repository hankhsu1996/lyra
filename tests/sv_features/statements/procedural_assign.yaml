feature: procedural_assign
description: Tests for procedural continuous assignments (assign/deassign)

cases:
  - name: basic_assign_constant
    description: Basic assign with constant value
    sv: |
      module Test;
        logic [7:0] q;
        initial begin
          q = 0;
          assign q = 42;
        end
      endmodule
    expect:
      variables:
        q: 42

  - name: assign_blocks_writes
    description: Writes are blocked while variable is under assign
    sv: |
      module Test;
        logic [7:0] q;
        initial begin
          assign q = 10;
          q = 99;  // Should be blocked
        end
      endmodule
    expect:
      variables:
        q: 10

  - name: deassign_releases
    description: Deassign releases the block, allowing writes
    sv: |
      module Test;
        logic [7:0] q;
        initial begin
          assign q = 10;
          q = 99;  // Blocked
          deassign q;
          q = 77;  // Now works
        end
      endmodule
    expect:
      variables:
        q: 77

  - name: value_persists_after_deassign
    description: Value persists after deassign (not reset)
    sv: |
      module Test;
        logic [7:0] q;
        initial begin
          assign q = 55;
          deassign q;
          // q should still be 55
        end
      endmodule
    expect:
      variables:
        q: 55

  - name: reassign_replaces
    description: Re-assigning replaces the previous assign value
    sv: |
      module Test;
        logic [7:0] q;
        initial begin
          assign q = 10;
          assign q = 20;  // Replaces previous
        end
      endmodule
    expect:
      variables:
        q: 20

  - name: deassign_without_assign
    description: Deassign without active assign is harmless
    sv: |
      module Test;
        logic [7:0] q;
        initial begin
          q = 42;
          deassign q;  // No effect
        end
      endmodule
    expect:
      variables:
        q: 42

  - name: assign_int
    description: Assign works with int type
    sv: |
      module Test;
        int x;
        initial begin
          x = 100;
          assign x = 200;
          x = 300;  // Blocked
        end
      endmodule
    expect:
      variables:
        x: 200
