feature: ternary
description: Tests for ternary conditional operator

cases:
  - name: literal
    sv: |
      module Test;
        int a;
        initial begin
          a = 1 ? 42 : 0;
        end
      endmodule
    expect:
      variables:
        a: 42

  - name: variable
    sv: |
      module Test;
        int a, b;
        initial begin
          b = 1;
          a = b ? 42 : 0;
        end
      endmodule
    expect:
      variables:
        a: 42

  - name: nested
    sv: |
      module Test;
        int a, b;
        initial begin
          b = 2;
          a = b == 1 ? 1 : (b == 2 ? 2 : 0);
        end
      endmodule
    expect:
      variables:
        a: 2

  - name: complex
    sv: |
      module Test;
        int a, b, c;
        initial begin
          b = 1;
          c = 1;
          a = (b * c == 1) ? 42 : 0;
        end
      endmodule
    expect:
      variables:
        a: 42

  - name: short_circuit_then
    description: Only then arm evaluated when condition is true (++m1 runs, ++m2 not)
    sv: |
      module Test;
        int a, b, m1, m2;
        initial begin
          m1 = 0;
          m2 = 0;
          b = 1;
          a = b ? ++m1 : ++m2;
        end
      endmodule
    expect:
      variables:
        a: 1
        m1: 1
        m2: 0

  - name: short_circuit_else
    description: Only else arm evaluated when condition is false (++m2 runs, ++m1 not)
    sv: |
      module Test;
        int a, b, m1, m2;
        initial begin
          m1 = 0;
          m2 = 0;
          b = 0;
          a = b ? ++m1 : ++m2;
        end
      endmodule
    expect:
      variables:
        a: 1
        m1: 0
        m2: 1

  - name: false_condition
    description: Ternary with false literal condition
    sv: |
      module Test;
        int a;
        initial begin
          a = 0 ? 42 : 99;
        end
      endmodule
    expect:
      variables:
        a: 99
