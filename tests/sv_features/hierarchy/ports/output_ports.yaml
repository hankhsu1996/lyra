feature: hierarchy_output_ports
description: Tests output port binding from child to parent

# Output variable ports: child owns its own storage, a connection process
# propagates values to the parent. Child reads from its own storage.
# Output/inout net ports: true aliasing (not yet implemented).

cases:
  - name: output_port_updates_parent
    description: Child output port updates parent signal
    sv: |
      module Generator(output int value);
        initial value = 42;
      endmodule

      module Top;
        int result;
        Generator gen(.value(result));

        initial #1;
      endmodule
    expect:
      variables:
        result: 42
      time: 1

  - name: sequential_output_port
    description: Sequential process writes to output port
    sv: |
      module Toggle(input bit clk, output bit state);
        always_ff @(posedge clk) state = ~state;
      endmodule

      module Top;
        bit clk, out;
        Toggle t(.clk(clk), .state(out));

        initial begin
          clk = 0;
          #1 clk = 1;
          #1 clk = 0;
          #1 clk = 1;
        end
      endmodule
    expect:
      variables:
        out: 0
      time: 3

  - name: multiple_output_ports
    description: Module with multiple output ports simultaneously
    sv: |
      module Splitter(input int x, output int a, output int b);
        always_comb begin
          a = x + 1;
          b = x + 2;
        end
      endmodule

      module Top;
        int input_val = 10;
        int out1, out2;
        Splitter splitter(.x(input_val), .a(out1), .b(out2));

        initial #1;
      endmodule
    expect:
      variables:
        out1: 11
        out2: 12
      time: 1

  # Note: inout ports require net types in SystemVerilog, not variables.
  # Tests for inout will be added when net type support is implemented.

  - name: output_display
    description: Child output displayed by parent
    sv: |
      module Child(output int result);
        initial result = 42;
      endmodule

      module Top;
        int out;
        Child c(.result(out));
        initial begin
          #1;
          $display("out=%0d", out);
        end
      endmodule
    expect:
      stdout: "out=42\n"

  - name: child_reads_own_output_variable
    description: Child reads its own output port (must see child storage, not parent)
    sv: |
      module Child(output int result);
        initial begin
          result = 42;
          $display("child=%0d", result);
        end
      endmodule

      module Top;
        int out = 0;
        Child c(.result(out));
        initial #1;
      endmodule
    expect:
      stdout: "child=42\n"
      variables:
        out: 42
      time: 1
