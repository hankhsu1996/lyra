feature: unpacked_arrays
description: Tests for fixed-size unpacked arrays

cases:
  - name: basic_declaration_and_access
    sv: |
      module Test;
        int result;
        initial begin
          int arr[4];
          arr[0] = 10;
          arr[1] = 20;
          arr[2] = 30;
          arr[3] = 40;
          result = arr[0] + arr[1] + arr[2] + arr[3];
        end
      endmodule
    expect:
      variables:
        result: 100

  - name: array_index_variable
    sv: |
      module Test;
        int result;
        initial begin
          int arr[3];
          int i;
          arr[0] = 5;
          arr[1] = 10;
          arr[2] = 15;
          i = 1;
          result = arr[i];
        end
      endmodule
    expect:
      variables:
        result: 10

  - name: array_loop_sum
    sv: |
      module Test;
        int result;
        initial begin
          int arr[5];
          int i;
          arr[0] = 1;
          arr[1] = 2;
          arr[2] = 3;
          arr[3] = 4;
          arr[4] = 5;
          result = 0;
          for (i = 0; i < 5; i++) begin
            result = result + arr[i];
          end
        end
      endmodule
    expect:
      variables:
        result: 15

  - name: array_modify_element
    sv: |
      module Test;
        int result;
        initial begin
          int arr[3];
          arr[0] = 100;
          arr[1] = 200;
          arr[2] = 300;
          arr[1] = arr[1] + 50;
          result = arr[1];
        end
      endmodule
    expect:
      variables:
        result: 250

  - name: array_display
    sv: |
      module Test;
        initial begin
          int arr[3];
          arr[0] = 1;
          arr[1] = 2;
          arr[2] = 3;
          $display("arr[0]=%d arr[1]=%d arr[2]=%d", arr[0], arr[1], arr[2]);
        end
      endmodule
    expect:
      output: "arr[0]=1 arr[1]=2 arr[2]=3\n"

  - name: module_level_array
    sv: |
      module Test;
        int arr[2];
        int result;
        initial begin
          arr[0] = 42;
          arr[1] = 58;
          result = arr[0] + arr[1];
        end
      endmodule
    expect:
      variables:
        result: 100

  - name: array_expression_index
    sv: |
      module Test;
        int result;
        initial begin
          int arr[4];
          int base;
          arr[0] = 10;
          arr[1] = 20;
          arr[2] = 30;
          arr[3] = 40;
          base = 1;
          result = arr[base + 1];
        end
      endmodule
    expect:
      variables:
        result: 30

  - name: nested_array_access
    sv: |
      module Test;
        int result;
        initial begin
          int arr[3];
          int idx[3];
          arr[0] = 100;
          arr[1] = 200;
          arr[2] = 300;
          idx[0] = 2;
          idx[1] = 0;
          idx[2] = 1;
          result = arr[idx[0]];
        end
      endmodule
    expect:
      variables:
        result: 300
