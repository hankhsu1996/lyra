feature: binary_operators
description: Tests for binary arithmetic, comparison, and logical operators

cases:
  - name: addition_basic
    sv: |
      module Test;
        int a, b, c;
        initial begin
          a = 10;
          b = 20;
          c = a + b;
        end
      endmodule
    expect:
      variables:
        c: 30

  - name: subtraction_basic
    sv: |
      module Test;
        int a, b, c;
        initial begin
          a = 30;
          b = 12;
          c = a - b;
        end
      endmodule
    expect:
      variables:
        c: 18

  - name: multiplication_basic
    sv: |
      module Test;
        int a, b, c;
        initial begin
          a = 5;
          b = 7;
          c = a * b;
        end
      endmodule
    expect:
      variables:
        c: 35

  - name: complex_expression
    sv: |
      module Test;
        int a, b, c, d;
        initial begin
          a = 5;
          b = 10;
          c = 3;
          d = a + b * c;
        end
      endmodule
    expect:
      variables:
        d: 35

  - name: comparison_equal
    sv: |
      module Test;
        int a, b;
        bit c, d;
        initial begin
          a = 10;
          b = 10;
          c = (a == b);
          d = (a == 11);
        end
      endmodule
    expect:
      variables:
        c: 1
        d: 0

  - name: comparison_not_equal
    sv: |
      module Test;
        int a, b;
        bit c, d;
        initial begin
          a = 10;
          b = 11;
          c = (a != b);
          d = (a != 10);
        end
      endmodule
    expect:
      variables:
        c: 1
        d: 0

  - name: comparison_less_than
    sv: |
      module Test;
        int a, b;
        bit c, d;
        initial begin
          a = 5;
          b = 10;
          c = (a < b);
          d = (b < a);
        end
      endmodule
    expect:
      variables:
        c: 1
        d: 0

  - name: comparison_less_than_equal
    sv: |
      module Test;
        int a, b, c;
        bit d, e, f;
        initial begin
          a = 5;
          b = 10;
          c = 5;
          d = (a <= b);
          e = (a <= c);
          f = (b <= a);
        end
      endmodule
    expect:
      variables:
        d: 1
        e: 1
        f: 0

  - name: comparison_greater_than
    sv: |
      module Test;
        int a, b;
        bit c, d;
        initial begin
          a = 15;
          b = 10;
          c = (a > b);
          d = (b > a);
        end
      endmodule
    expect:
      variables:
        c: 1
        d: 0

  - name: comparison_greater_than_equal
    sv: |
      module Test;
        int a, b, c;
        bit d, e, f;
        initial begin
          a = 15;
          b = 10;
          c = 15;
          d = (a >= b);
          e = (a >= c);
          f = (b >= a);
        end
      endmodule
    expect:
      variables:
        d: 1
        e: 1
        f: 0

  - name: bitwise_and
    sv: |
      module Test;
        int a, b, c;
        initial begin
          a = 5;
          b = 3;
          c = a & b;
        end
      endmodule
    expect:
      variables:
        c: 1

  - name: bitwise_or
    sv: |
      module Test;
        int a, b, c;
        initial begin
          a = 5;
          b = 3;
          c = a | b;
        end
      endmodule
    expect:
      variables:
        c: 7

  - name: bitwise_xor
    sv: |
      module Test;
        int a, b, c;
        initial begin
          a = 5;
          b = 3;
          c = a ^ b;
        end
      endmodule
    expect:
      variables:
        c: 6

  - name: bitwise_xnor
    sv: |
      module Test;
        int a, b, c;
        initial begin
          a = 5;
          b = 3;
          c = a ~^ b;
        end
      endmodule
    expect:
      variables:
        c: -7

  - name: bitwise_xnor_alt
    sv: |
      module Test;
        int a, b, c;
        initial begin
          a = 5;
          b = 3;
          c = a ^~ b;
        end
      endmodule
    expect:
      variables:
        c: -7

  - name: logical_and
    sv: |
      module Test;
        int a, b;
        bit r1, r2, r3;
        initial begin
          a = 5;
          b = 0;
          r1 = a && b;
          r2 = a && 1;
          r3 = b && b;
        end
      endmodule
    expect:
      variables:
        r1: 0
        r2: 1
        r3: 0

  - name: logical_or
    sv: |
      module Test;
        int a, b;
        bit r1, r2, r3;
        initial begin
          a = 5;
          b = 0;
          r1 = a || b;
          r2 = b || b;
          r3 = a || a;
        end
      endmodule
    expect:
      variables:
        r1: 1
        r2: 0
        r3: 1

  - name: shift_left
    sv: |
      module Test;
        int a, b;
        initial begin
          a = 8;
          b = a << 2;
        end
      endmodule
    expect:
      variables:
        b: 32

  - name: shift_right
    sv: |
      module Test;
        int a, b;
        initial begin
          a = 32;
          b = a >> 2;
        end
      endmodule
    expect:
      variables:
        b: 8

  - name: shift_arith_right_signed
    sv: |
      module Test;
        int a, b, c;
        initial begin
          a = -8;
          b = 2;
          c = a >>> b;
        end
      endmodule
    expect:
      variables:
        c: -2

  - name: shift_logic_right_signed
    sv: |
      module Test;
        int a, b, c;
        initial begin
          a = -8;
          b = 2;
          c = a >> b;
        end
      endmodule
    expect:
      variables:
        c: 1073741822

  - name: shift_arith_left_signed
    sv: |
      module Test;
        int a, b, c;
        initial begin
          a = -8;
          b = 2;
          c = a <<< b;
        end
      endmodule
    expect:
      variables:
        c: -32

  - name: shift_logic_left_signed
    sv: |
      module Test;
        int a, b, c;
        initial begin
          a = -8;
          b = 2;
          c = a << b;
        end
      endmodule
    expect:
      variables:
        c: -32

  - name: addition_bit_and_int
    sv: |
      module Test;
        bit a;
        int b, c;
        initial begin
          a = 1;
          b = 10;
          c = a + b;
        end
      endmodule
    expect:
      variables:
        c: 11

  - name: addition_int_and_longint
    sv: |
      module Test;
        int a;
        longint b, c;
        initial begin
          a = 100;
          b = 1000;
          c = a + b;
        end
      endmodule
    expect:
      variables:
        c: 1100

  - name: addition_bit_and_longint
    sv: |
      module Test;
        bit a;
        longint b, c;
        initial begin
          a = 1;
          b = 1000;
          c = a + b;
        end
      endmodule
    expect:
      variables:
        c: 1001

  - name: comparison_signed_negative_high_bits
    description: Signed comparison with values differing only in high bits
    sv: |
      module Test;
        int a, b;
        bit lt, gt, eq;
        initial begin
          // 0x80000003 (-2147483645) vs 0x00000003 (3)
          a = 32'h80000003;
          b = 32'h00000003;
          lt = (a < b);
          gt = (a > b);
          eq = (a == b);
        end
      endmodule
    expect:
      variables:
        lt: 1
        gt: 0
        eq: 0

  - name: comparison_signed_against_zero
    description: Signed comparison of negative value against zero
    sv: |
      module Test;
        int a;
        bit lt_zero, ge_zero;
        initial begin
          a = 32'h80000003;  // -2147483645
          lt_zero = (a < 0);
          ge_zero = (a >= 0);
        end
      endmodule
    expect:
      variables:
        lt_zero: 1
        ge_zero: 0

  - name: comparison_signed_minmax
    description: Signed comparison at INT_MIN and INT_MAX boundaries
    sv: |
      module Test;
        int min_val, max_val, zero;
        bit min_lt_zero, min_lt_max, max_gt_zero;
        initial begin
          min_val = 32'h80000000;  // INT_MIN (-2147483648)
          max_val = 32'h7FFFFFFF;  // INT_MAX (2147483647)
          zero = 0;
          min_lt_zero = (min_val < zero);
          min_lt_max = (min_val < max_val);
          max_gt_zero = (max_val > zero);
        end
      endmodule
    expect:
      variables:
        min_lt_zero: 1
        min_lt_max: 1
        max_gt_zero: 1

  - name: comparison_equality_high_bits
    description: Equality comparison with high bits set
    sv: |
      module Test;
        int a, b;
        bit eq, ne;
        initial begin
          a = 32'hFFFFFFFF;  // -1
          b = 32'hFFFFFFFF;
          eq = (a == b);
          ne = (a != 32'h7FFFFFFF);
        end
      endmodule
    expect:
      variables:
        eq: 1
        ne: 1

  - name: comparison_mixed_width_signed
    description: Comparison of narrower signed value with wider signed value
    sv: |
      module Test;
        byte a;       // 8-bit signed
        int b;        // 32-bit signed
        bit lt, gt;
        initial begin
          a = -1;     // 0xFF as byte, sign-extends to -1 as int
          b = 100;
          lt = (a < b);
          gt = (a > b);
        end
      endmodule
    expect:
      variables:
        lt: 1
        gt: 0

  - name: comparison_mixed_width_unsigned
    description: Comparison of narrower unsigned value with wider signed value
    sv: |
      module Test;
        bit [7:0] a;  // 8-bit unsigned
        int b;        // 32-bit signed
        bit lt, gt;
        initial begin
          a = 8'hFF;  // 255 as unsigned, zero-extends to 255
          b = 100;
          lt = (a < b);
          gt = (a > b);
        end
      endmodule
    expect:
      variables:
        lt: 0
        gt: 1
