feature: display
description: Tests for $display system task output

cases:
  - name: display_string
    sv: |
      module Test;
        initial $display("Hello World");
      endmodule
    expect:
      output: "Hello World\n"

  - name: display_empty
    sv: |
      module Test;
        initial $display();
      endmodule
    expect:
      output: "\n"

  - name: display_integer
    sv: |
      module Test;
        int x;
        initial begin
          x = 42;
          $display("%d", x);
        end
      endmodule
    expect:
      output: "42\n"

  - name: display_multiple_values
    sv: |
      module Test;
        int a, b;
        initial begin
          a = 10;
          b = 20;
          $display("a=%d b=%d", a, b);
        end
      endmodule
    expect:
      output: "a=10 b=20\n"

  - name: display_hex_format
    sv: |
      module Test;
        int x;
        initial begin
          x = 255;
          $display("%h", x);
        end
      endmodule
    expect:
      output: "ff\n"

  - name: display_binary_format
    sv: |
      module Test;
        int x;
        initial begin
          x = 5;
          $display("%b", x);
        end
      endmodule
    expect:
      output: "101\n"

  - name: display_multiple_calls
    sv: |
      module Test;
        initial begin
          $display("line 1");
          $display("line 2");
        end
      endmodule
    expect:
      output: |
        line 1
        line 2

  - name: display_no_format_string
    sv: |
      module Test;
        int x;
        initial begin
          x = 99;
          $display(x);
        end
      endmodule
    expect:
      output: "99\n"

  - name: display_contains_check
    sv: |
      module Test;
        initial begin
          $display("prefix data suffix");
          $display("more output");
        end
      endmodule
    expect:
      output:
        contains:
          - "data"
          - "more"

  - name: display_real_default_precision
    sv: |
      module Test;
        real x;
        initial begin
          x = 1.5;
          $display("%f", x);
        end
      endmodule
    expect:
      output: "1.500000\n"

  - name: display_real_with_precision
    sv: |
      module Test;
        real x;
        initial begin
          x = 3.14159;
          $display("%.3f", x);
        end
      endmodule
    expect:
      output: "3.142\n"

  - name: display_integer_width
    sv: |
      module Test;
        int x;
        initial begin
          x = 42;
          $display("%5d", x);
        end
      endmodule
    expect:
      output: "   42\n"

  - name: display_integer_zero_pad
    sv: |
      module Test;
        int x;
        initial begin
          x = 42;
          $display("%05d", x);
        end
      endmodule
    expect:
      output: "00042\n"

  - name: display_hex_zero_pad
    sv: |
      module Test;
        int x;
        initial begin
          x = 255;
          $display("%04h", x);
        end
      endmodule
    expect:
      output: "00ff\n"

  - name: display_binary_zero_pad
    sv: |
      module Test;
        int x;
        initial begin
          x = 5;
          $display("%08b", x);
        end
      endmodule
    expect:
      output: "00000101\n"

  - name: display_string_width
    sv: |
      module Test;
        string s;
        initial begin
          s = "hi";
          $display("[%5s]", s);
        end
      endmodule
    expect:
      output: "[   hi]\n"

  - name: display_string_left_align
    sv: |
      module Test;
        string s;
        initial begin
          s = "hi";
          $display("[%-5s]", s);
        end
      endmodule
    expect:
      output: "[hi   ]\n"

  # $write variants (no newline)
  - name: write_no_newline
    sv: |
      module Test;
        initial begin
          $write("no");
          $write("newline");
        end
      endmodule
    expect:
      output: "nonewline"

  - name: write_empty_does_nothing
    sv: |
      module Test;
        initial begin
          $write();
          $write("done");
        end
      endmodule
    expect:
      output: "done"

  - name: writeh_default_hex
    sv: |
      module Test;
        int x;
        initial begin
          x = 255;
          $writeh(x);
        end
      endmodule
    expect:
      output: "ff"

  - name: writeb_default_binary
    sv: |
      module Test;
        int x;
        initial begin
          x = 5;
          $writeb(x);
        end
      endmodule
    expect:
      output: "101"

  - name: writeo_default_octal
    sv: |
      module Test;
        int x;
        initial begin
          x = 8;
          $writeo(x);
        end
      endmodule
    expect:
      output: "10"

  # $display variants (with newline, different default format)
  - name: displayh_default_hex
    sv: |
      module Test;
        int x;
        initial begin
          x = 255;
          $displayh(x);
        end
      endmodule
    expect:
      output: "ff\n"

  - name: displayb_default_binary
    sv: |
      module Test;
        int x;
        initial begin
          x = 5;
          $displayb(x);
        end
      endmodule
    expect:
      output: "101\n"

  - name: displayo_default_octal
    sv: |
      module Test;
        int x;
        initial begin
          x = 8;
          $displayo(x);
        end
      endmodule
    expect:
      output: "10\n"

  # Format string overrides default
  - name: displayh_with_format_uses_format
    sv: |
      module Test;
        int x;
        initial begin
          x = 255;
          $displayh("%d", x);
        end
      endmodule
    expect:
      output: "255\n"

  - name: writeb_with_format_uses_format
    sv: |
      module Test;
        int x;
        initial begin
          x = 255;
          $writeb("%h", x);
        end
      endmodule
    expect:
      output: "ff"

  # Multiple values with variant default
  - name: displayh_multiple_values
    sv: |
      module Test;
        int a, b;
        initial begin
          a = 10;
          b = 255;
          $displayh(a, b);
        end
      endmodule
    expect:
      output: "aff\n"

  # Mixed types - integers use variant format, others use default
  - name: displayh_mixed_types
    sv: |
      module Test;
        int x;
        string s;
        initial begin
          x = 255;
          s = "test";
          $displayh(x, s);
        end
      endmodule
    expect:
      output: "fftest\n"
