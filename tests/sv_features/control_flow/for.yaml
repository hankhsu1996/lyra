feature: for loops
description: Tests for for loop construct

cases:
  - name: basic_counter
    description: Standard for loop with external variable
    sv: |
      module Test;
        int i;
        int sum;
        initial begin
          sum = 0;
          for (i = 0; i < 5; i = i + 1) begin
            sum = sum + i;
          end
        end
      endmodule
    expect:
      variables:
        i: 5
        sum: 10

  - name: loop_var_declaration
    description: For loop with variable declared in initializer
    sv: |
      module Test;
        int sum;
        initial begin
          sum = 0;
          for (int i = 0; i < 5; i = i + 1) begin
            sum = sum + i;
          end
        end
      endmodule
    expect:
      variables:
        sum: 10

  - name: multiple_initializers
    description: For loop with multiple initializer expressions
    sv: |
      module Test;
        int i, j, sum;
        initial begin
          sum = 0;
          for (i = 0, j = 3; i < 3; i = i + 1, j = j + 1) begin
            sum = sum + i + j;
          end
        end
      endmodule
    expect:
      variables:
        sum: 15

  - name: empty_initializer
    description: For loop with empty initializer section
    sv: |
      module Test;
        int i;
        int sum;
        initial begin
          i = 1;
          sum = 0;
          for (; i <= 3; i = i + 1) begin
            sum = sum + i;
          end
        end
      endmodule
    expect:
      variables:
        i: 4
        sum: 6

  - name: empty_step
    description: For loop with empty step section (manual increment in body)
    sv: |
      module Test;
        int i;
        int x;
        initial begin
          x = 0;
          for (i = 0; i < 1;) begin
            x = x + 1;
            i = i + 1;
          end
        end
      endmodule
    expect:
      variables:
        x: 1
        i: 1

  - name: nested
    description: Nested for loops
    sv: |
      module Test;
        int i, j, product;
        initial begin
          product = 1;
          for (i = 1; i <= 2; i = i + 1) begin
            for (j = 1; j <= 2; j = j + 1) begin
              product = product * j;
            end
          end
        end
      endmodule
    expect:
      variables:
        product: 4

  - name: break
    description: Break exits for loop early
    sv: |
      module Test;
        int i;
        initial begin
          for (i = 0; i < 10; i = i + 1) begin
            if (i == 4) break;
          end
        end
      endmodule
    expect:
      variables:
        i: 4

  - name: break_inner_only
    description: Break only exits innermost loop
    sv: |
      module Test;
        int i, j, count;
        initial begin
          count = 0;
          for (i = 0; i < 2; i = i + 1) begin
            j = 0;
            while (j < 3) begin
              if (j == 1) break;
              count = count + 1;
              j = j + 1;
            end
          end
        end
      endmodule
    expect:
      variables:
        count: 2
