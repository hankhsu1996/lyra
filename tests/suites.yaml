# Test suite definitions
#
# Suites define backend + test selection (closed contracts for CI).
# Patterns are regex substrings matched against relative paths.
# Empty include_regex = all YAML files. Exclude wins over include.

suites:
  jit_dev:
    backend: jit
    include_regex:
      - control_flow/
      - datatypes/
      - directives/
      - functions/
      - generate/
      - hierarchy/
      - lifecycle/
      - metadata/
      - operators/
      - packages/
      - processes/
      - scheduling/
      - system_tf/
      - trace/
    exclude_regex:
      - system_tf/effect/system_cmd\.yaml # MIR-only ($system not in LLVM)

  lli_dev:
    backend: lli
    include_regex:
      - control_flow/
      - datatypes/
      - directives/
      - functions/
      - generate/
      - hierarchy/
      - lifecycle/
      - metadata/
      - operators/
      - packages/
      - processes/
      - scheduling/
      - system_tf/
      - trace/
    exclude_regex:
      - system_tf/effect/system_cmd\.yaml # MIR-only ($system not in LLVM)

  # Two-state regression suite: runs JIT with --two-state (all types forced
  # to 2-state LLVM representation). Covers layout, compute, commit, display,
  # and scheduling paths to prevent half-switch regressions.
  #
  # Selection: explicit include list (not all-minus-excludes) while the feature
  # stabilizes. Once stable (~2-3 weeks), flip to jit_dev's include list with
  # exclude_regex for 4-state-dependent tests. The exclude list is the spec:
  # keep it as small as possible.
  #
  # 4-state-dependent tests (must stay excluded under two-state):
  #   - casez/casex (wildcard matching depends on X/Z bits)
  #   - ===/!== with X operands (identity comparison needs unknown plane)
  #   - Tests that assert X-initialized values (e.g., result: "8'hxx")
  jit_two_state:
    backend: jit
    two_state: true
    include_regex:
      # Packed logic assignments and bit-range operations
      - datatypes/packed/packed_integral_default\.yaml
      - datatypes/packed/indexed_part_select\.yaml
      - datatypes/packed/packed_struct\.yaml
      # Operators (2-state compatible only)
      - operators/binary_two_state\.yaml
      - operators/unary_two_state\.yaml
      - operators/concat\.yaml
      # Control flow (guarded assigns, ternary)
      - control_flow/ternary\.yaml
      - control_flow/conditional\.yaml
      - control_flow/for\.yaml
      # Function calls
      - functions/basic\.yaml
      - functions/nested_calls\.yaml
      # Display formatting
      - system_tf/pure/conversions\.yaml
      - system_tf/pure/sformat\.yaml
      # Scheduling and edge triggers
      - scheduling/nba_packed\.yaml
      - scheduling/sub_slot_observation\.yaml

  mir_dev:
    backend: mir
    include_regex:
      - control_flow/
      - datatypes/
      - functions/
      - generate/
      - hierarchy/refs/
      - lifecycle/
      - operators/
      - packages/
      - system_tf/effect/
      - system_tf/pure/
      - system_tf/state/random\.yaml
      - trace/
    exclude_regex:
      - trace/bulk_ops\.yaml # JIT-only (requires flush-based trace via UpdateSet)
      - trace/update_set\.yaml # JIT-only (requires UpdateSet)
