feature: math_system_functions
description: Tests for IEEE 1800-2023 ยง20.8 math system functions

cases:
  - name: ln_e
    sv: |
      module Test;
        real x;
        initial begin
          x = $ln(2.718281828459045);
          $display("%f", x);
        end
      endmodule
    expect:
      stdout: "1.000000\n"

  - name: log10_100
    sv: |
      module Test;
        real x;
        initial begin
          x = $log10(100.0);
          $display("%f", x);
        end
      endmodule
    expect:
      stdout: "2.000000\n"

  - name: exp_1
    sv: |
      module Test;
        real x;
        initial begin
          x = $exp(1.0);
          $display("%f", x);
        end
      endmodule
    expect:
      stdout: "2.718282\n"

  - name: sqrt_4
    sv: |
      module Test;
        real x;
        initial begin
          x = $sqrt(4.0);
          $display("%f", x);
        end
      endmodule
    expect:
      stdout: "2.000000\n"

  - name: floor_positive
    sv: |
      module Test;
        real x;
        initial begin
          x = $floor(3.7);
          $display("%f", x);
        end
      endmodule
    expect:
      stdout: "3.000000\n"

  - name: floor_negative
    sv: |
      module Test;
        real x;
        initial begin
          x = $floor(-2.3);
          $display("%f", x);
        end
      endmodule
    expect:
      stdout: "-3.000000\n"

  - name: ceil_positive
    sv: |
      module Test;
        real x;
        initial begin
          x = $ceil(3.2);
          $display("%f", x);
        end
      endmodule
    expect:
      stdout: "4.000000\n"

  - name: ceil_negative
    sv: |
      module Test;
        real x;
        initial begin
          x = $ceil(-2.7);
          $display("%f", x);
        end
      endmodule
    expect:
      stdout: "-2.000000\n"

  - name: sin_pi_over_2
    sv: |
      module Test;
        real x;
        initial begin
          x = $sin(1.5707963267948966);
          $display("%f", x);
        end
      endmodule
    expect:
      stdout: "1.000000\n"

  - name: cos_zero
    sv: |
      module Test;
        real x;
        initial begin
          x = $cos(0.0);
          $display("%f", x);
        end
      endmodule
    expect:
      stdout: "1.000000\n"

  - name: tan_zero
    sv: |
      module Test;
        real x;
        initial begin
          x = $tan(0.0);
          $display("%f", x);
        end
      endmodule
    expect:
      stdout: "0.000000\n"

  - name: asin_1
    sv: |
      module Test;
        real x;
        initial begin
          x = $asin(1.0);
          $display("%f", x);
        end
      endmodule
    expect:
      stdout: "1.570796\n"

  - name: acos_1
    sv: |
      module Test;
        real x;
        initial begin
          x = $acos(1.0);
          $display("%f", x);
        end
      endmodule
    expect:
      stdout: "0.000000\n"

  - name: atan_1
    sv: |
      module Test;
        real x;
        initial begin
          x = $atan(1.0);
          $display("%f", x);
        end
      endmodule
    expect:
      stdout: "0.785398\n"

  - name: sinh_zero
    sv: |
      module Test;
        real x;
        initial begin
          x = $sinh(0.0);
          $display("%f", x);
        end
      endmodule
    expect:
      stdout: "0.000000\n"

  - name: cosh_zero
    sv: |
      module Test;
        real x;
        initial begin
          x = $cosh(0.0);
          $display("%f", x);
        end
      endmodule
    expect:
      stdout: "1.000000\n"

  - name: tanh_zero
    sv: |
      module Test;
        real x;
        initial begin
          x = $tanh(0.0);
          $display("%f", x);
        end
      endmodule
    expect:
      stdout: "0.000000\n"

  - name: asinh_zero
    sv: |
      module Test;
        real x;
        initial begin
          x = $asinh(0.0);
          $display("%f", x);
        end
      endmodule
    expect:
      stdout: "0.000000\n"

  - name: acosh_1
    sv: |
      module Test;
        real x;
        initial begin
          x = $acosh(1.0);
          $display("%f", x);
        end
      endmodule
    expect:
      stdout: "0.000000\n"

  - name: atanh_zero
    sv: |
      module Test;
        real x;
        initial begin
          x = $atanh(0.0);
          $display("%f", x);
        end
      endmodule
    expect:
      stdout: "0.000000\n"

  - name: atan2_basic
    sv: |
      module Test;
        real x;
        initial begin
          x = $atan2(1.0, 1.0);
          $display("%f", x);
        end
      endmodule
    expect:
      stdout: "0.785398\n"

  - name: hypot_3_4
    sv: |
      module Test;
        real x;
        initial begin
          x = $hypot(3.0, 4.0);
          $display("%f", x);
        end
      endmodule
    expect:
      stdout: "5.000000\n"

  - name: pow_basic
    sv: |
      module Test;
        real x;
        initial begin
          x = $pow(2.0, 10.0);
          $display("%f", x);
        end
      endmodule
    expect:
      stdout: "1024.000000\n"

  - name: clog2_zero
    sv: |
      module Test;
        int x;
        initial begin
          x = $clog2(0);
          $display("%0d", x);
        end
      endmodule
    expect:
      stdout: "0\n"

  - name: clog2_one
    sv: |
      module Test;
        int x;
        initial begin
          x = $clog2(1);
          $display("%0d", x);
        end
      endmodule
    expect:
      stdout: "0\n"

  - name: clog2_two
    sv: |
      module Test;
        int x;
        initial begin
          x = $clog2(2);
          $display("%0d", x);
        end
      endmodule
    expect:
      stdout: "1\n"

  - name: clog2_power_of_two
    sv: |
      module Test;
        int x;
        initial begin
          x = $clog2(256);
          $display("%0d", x);
        end
      endmodule
    expect:
      stdout: "8\n"

  - name: clog2_non_power_of_two
    sv: |
      module Test;
        int x;
        initial begin
          x = $clog2(7);
          $display("%0d", x);
        end
      endmodule
    expect:
      stdout: "3\n"

  - name: clog2_large
    sv: |
      module Test;
        int x;
        initial begin
          x = $clog2(1025);
          $display("%0d", x);
        end
      endmodule
    expect:
      stdout: "11\n"

  - name: clog2_boundary_values
    sv: |
      module Test;
        int x;
        initial begin
          x = $clog2(3);
          $display("%0d", x);
          x = $clog2(4);
          $display("%0d", x);
          x = $clog2(5);
          $display("%0d", x);
        end
      endmodule
    expect:
      stdout: |
        2
        2
        3

  - name: clog2_powers_plus_one
    sv: |
      module Test;
        int x;
        initial begin
          x = $clog2(9);
          $display("%0d", x);
          x = $clog2(17);
          $display("%0d", x);
          x = $clog2(33);
          $display("%0d", x);
          x = $clog2(65);
          $display("%0d", x);
        end
      endmodule
    expect:
      stdout: |
        4
        5
        6
        7

  - name: clog2_runtime_value
    sv: |
      module Test;
        int n, x;
        initial begin
          n = 16;
          x = $clog2(n);
          $display("%0d", x);
          n = 15;
          x = $clog2(n);
          $display("%0d", x);
          n = 0;
          x = $clog2(n);
          $display("%0d", x);
        end
      endmodule
    expect:
      stdout: |
        4
        4
        0

  - name: clog2_byte_width
    sv: |
      module Test;
        byte b;
        int x;
        initial begin
          b = 8'd128;
          x = $clog2(b);
          $display("%0d", x);
          b = 8'd255;
          x = $clog2(b);
          $display("%0d", x);
        end
      endmodule
    expect:
      stdout: |
        7
        8

  - name: sqrt_chain
    sv: |
      module Test;
        real x;
        initial begin
          x = $sqrt($sqrt(16.0));
          $display("%f", x);
        end
      endmodule
    expect:
      stdout: "2.000000\n"

  - name: exp_ln_identity
    sv: |
      module Test;
        real x;
        initial begin
          x = $exp($ln(5.0));
          $display("%f", x);
        end
      endmodule
    expect:
      stdout: "5.000000\n"
