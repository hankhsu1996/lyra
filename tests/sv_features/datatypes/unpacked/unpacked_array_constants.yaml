feature: unpacked_array_constants
description: Tests for unpacked arrays initialized with assignment patterns

cases:
  - name: int_array
    sv: |
      module Test;
        parameter int vals[3] = '{10, 20, 30};
        int result;
        initial begin
          result = vals[0] + vals[1] + vals[2];
        end
      endmodule
    expect:
      variables:
        result: 60

  - name: packed_struct_array
    sv: |
      module Test;
        typedef struct packed {
          logic [3:0] a;
          logic [3:0] b;
        } pair_t;

        parameter pair_t pairs[2] = '{
          '{a: 4'd1, b: 4'd2},
          '{a: 4'd3, b: 4'd4}
        };

        int result;
        initial begin
          result = pairs[0] + pairs[1];
        end
      endmodule
    expect:
      variables:
        result: 70

  - name: bit_vector_array
    sv: |
      module Test;
        parameter bit [7:0] bytes[3] = '{8'h10, 8'h20, 8'h30};
        int result;
        initial begin
          result = bytes[0] + bytes[1] + bytes[2];
        end
      endmodule
    expect:
      variables:
        result: 96

  - name: variable_index
    sv: |
      module Test;
        parameter int values[4] = '{1, 2, 4, 8};
        int sum;
        initial begin
          sum = 0;
          for (int i = 0; i < 4; i++) begin
            sum = sum + values[i];
          end
        end
      endmodule
    expect:
      variables:
        sum: 15

  - name: default_zero
    sv: |
      module Test;
        int arr[4] = '{default: 0};
        int result;
        initial result = arr[0] + arr[1] + arr[2] + arr[3];
      endmodule
    expect:
      variables:
        result: 0

  - name: default_value
    sv: |
      module Test;
        int arr[3] = '{default: 5};
        int result;
        initial result = arr[0] + arr[1] + arr[2];
      endmodule
    expect:
      variables:
        result: 15

  - name: default_with_override
    sv: |
      module Test;
        int arr[4] = '{default: 1, 2: 10};
        int result;
        initial result = arr[0] + arr[1] + arr[2] + arr[3];
      endmodule
    expect:
      variables:
        result: 13

  - name: bit_array_default
    sv: |
      module Test;
        bit unused[3] = '{default: 1'b0};
        int result;
        initial result = unused[0] + unused[1] + unused[2];
      endmodule
    expect:
      variables:
        result: 0
