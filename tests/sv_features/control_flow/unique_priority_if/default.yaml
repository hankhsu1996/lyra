feature: unique_priority_if
description: Tests for unique/unique0/priority if statements (LRM 12.4.2)

cases:
  - name: priority_no_match_warning
    description: priority if warns when no condition matches and no else
    sv: |
      module Test;
        int sel, result;
        initial begin
          sel = 5;
          result = 100;
          priority if (sel == 0)
            result = 10;
          else if (sel == 1)
            result = 20;
          $display("done");
        end
      endmodule
    expect:
      variables:
        result: 100
      stdout:
        contains:
          - "warning"
          - "no condition matched"

  - name: priority_else_suppresses_warning
    description: else clause suppresses no-match warning
    sv: |
      module Test;
        int sel, result;
        initial begin
          sel = 5;
          result = 0;
          priority if (sel == 0)
            result = 10;
          else if (sel == 1)
            result = 20;
          else
            result = 99;
        end
      endmodule
    expect:
      variables:
        result: 99
      stdout:
        not_contains:
          - "warning"

  - name: unique_overlap_warning
    description: unique if warns when multiple conditions are true
    sv: |
      module Test;
        int a, b, result;
        initial begin
          a = 1; b = 1;
          result = 0;
          unique if (a)
            result = 10;
          else if (b)
            result = 20;
          $display("done");
        end
      endmodule
    expect:
      variables:
        result: 10
      stdout:
        contains:
          - "warning"
          - "multiple conditions"

  - name: unique_no_match_warning
    description: unique if warns when no condition matches
    sv: |
      module Test;
        int a, b, result;
        initial begin
          a = 0; b = 0;
          result = 100;
          unique if (a)
            result = 10;
          else if (b)
            result = 20;
          $display("done");
        end
      endmodule
    expect:
      variables:
        result: 100
      stdout:
        contains:
          - "warning"
          - "no condition matched"

  - name: unique0_no_match_no_warning
    description: unique0 if does NOT warn on no-match (key difference from unique)
    sv: |
      module Test;
        int a, b, result;
        initial begin
          a = 0; b = 0;
          result = 100;
          unique0 if (a)
            result = 10;
          else if (b)
            result = 20;
        end
      endmodule
    expect:
      variables:
        result: 100
      stdout:
        not_contains:
          - "warning"

  # Note: SystemVerilog doesn't allow "else unique if" or "else priority if" -
  # qualifiers can only appear at the start of the if statement. Mixed qualifiers
  # require nested blocks: unique if (...) ... else begin priority if (...) end
  # The FlattenIfElseChain logic handles this defensively but can't be tested
  # directly since slang rejects the invalid syntax.

  - name: unique0_overlap_warning
    description: unique0 if warns on overlap (same as unique)
    sv: |
      module Test;
        int a, b, result;
        initial begin
          a = 1; b = 1;
          result = 0;
          unique0 if (a)
            result = 10;
          else if (b)
            result = 20;
          $display("done");
        end
      endmodule
    expect:
      variables:
        result: 10
      stdout:
        contains:
          - "warning"
          - "multiple conditions"
          - "unique0"
