# Test suite definitions
#
# Suites define backend + test selection (closed contracts for CI).
# Patterns are regex substrings matched against relative paths.
# Empty include_regex = all YAML files. Exclude wins over include.
#
# Directory convention for test files:
#   feature/default.yaml         - Default tests (runs in all suites)
#   feature/four_state.yaml      - 4-state only (excluded from jit_two_state)
#   feature/two_state_only.yaml  - Semantic diff (excluded from jit_dev)

suites:
  jit_dev:
    backend: jit
    include_regex:
      - control_flow/
      - datatypes/
      - directives/
      - functions/
      - generate/
      - hierarchy/
      - lifecycle/
      - metadata/
      - mutation/
      - operators/
      - packages/
      - processes/
      - scheduling/
      - system_tf/
      - trace/
    exclude_regex:
      - two_state_only\.yaml$ # Two-state semantic diff only

  lli_dev:
    backend: lli
    include_regex:
      - control_flow/
      - datatypes/
      - directives/
      - functions/
      - generate/
      - hierarchy/
      - lifecycle/
      - metadata/
      - mutation/
      - operators/
      - packages/
      - processes/
      - scheduling/
      - system_tf/
      - trace/
    exclude_regex:
      - two_state_only\.yaml$ # Two-state semantic diff only

  # Two-state regression suite: runs JIT with --two-state (all types forced
  # to 2-state LLVM representation). Uses same test scope as jit_dev minus
  # tests that depend on 4-state semantics (X/Z values, casez/casex patterns,
  # identity comparisons with unknown bits).
  jit_two_state:
    backend: jit
    two_state: true
    include_regex:
      - control_flow/
      - datatypes/
      - directives/
      - functions/
      - generate/
      - hierarchy/
      - lifecycle/
      - metadata/
      - operators/
      - packages/
      - processes/
      - scheduling/
      - system_tf/
      - trace/
    exclude_regex:
      - four_state\.yaml$ # All 4-state-dependent tests
      # TODO: dynamic array/queue query bugs under --two-state (not 4-state related)
      - system_tf/pure/array_query/default\.yaml$

  mir_dev:
    backend: mir
    include_regex:
      - ^control_flow/
      - ^datatypes/
      - ^functions/
      - ^generate/
      - ^hierarchy/refs/
      - ^lifecycle/
      - ^mutation/
      - ^operators/
      - ^packages/
      - ^system_tf/effect/
      - ^system_tf/pure/
      - ^system_tf/state/random/
      - ^trace/
    exclude_regex:
      - trace/bulk_ops/ # JIT-only (requires flush-based trace via UpdateSet)
      - trace/update_set/ # JIT-only (requires UpdateSet)
      - two_state_only\.yaml$ # Two-state semantic diff only
